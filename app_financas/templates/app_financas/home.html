{% extends 'base.html' %}

{% block content %}
<h1>Resumo Financeiro - {{ mes }} {{ ano }}</h1>

<div class="row">
    <div class="col-md-6">
        <table class="table">
            <tr>
                <th>Resumo</th>
                <th>Valor (R$)</th>
            </tr>
            <tr>
                <td>ðŸŸ¢ Entrou</td>
                <td>R$ {{ entradas|floatformat:2 }}</td>
            </tr>
            <tr>
                <td>ðŸ”´ Saiu (exceto Total Faturas)</td>
                <td>R$ {{ saidas_sem_faturas|floatformat:2 }}</td>
            </tr>
            <tr>
                <td>ðŸ”´ Total Faturas</td>
                <td>R$ {{ total_faturas|floatformat:2 }}</td>
            </tr>
            <tr>
                <td><strong>Sobrou</strong></td>
                <td><strong>R$ {{ saldo_final|floatformat:2 }}</strong></td>
            </tr>
        </table>
    </div>
    
    <div class="col-md-6">
        <canvas id="grafico-pizza"></canvas>
    </div>
</div>

<h2>Ãšltimas TransaÃ§Ãµes</h2>
<table class="table">
    <thead>
        <tr>
            <th>Data</th>
            <th>Tipo</th>
            <th>DescriÃ§Ã£o</th>
            <th>Valor</th>
        </tr>
    </thead>
    <tbody>
        {% for transacao in transacoes %}
        <tr>
            <td>{{ transacao.data }}</td>
            <td>{{ transacao.get_tipo_display }}</td>
            <td>{{ transacao.descricao }}</td>
            <td>R$ {{ transacao.valor|floatformat:2 }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'transacao_create' %}" class="btn btn-primary">Nova TransaÃ§Ã£o</a>

<script>
    var ctx = document.getElementById('grafico-pizza').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Entradas', 'SaÃ­das'],
            datasets: [{
                data: [{{ entradas }}, {{ saidas }}],
                backgroundColor: ['#28a745', '#dc3545']
            }]
        },
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'DistribuiÃ§Ã£o de Entradas e SaÃ­das'
            }
        }
    });
</script>
{% endblock %}